<template>
  <require from="./search.scss"></require>

    <div class="mdc-layout-grid">
      <div class="mdc-layout-grid__inner">
        <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-11">
          <mdc-text-field name="q" value.two-way="query.q" outlined label="Search" style="width: 100%; height: 36px;"></mdc-text-field>        
        </div>
        <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-1">
          <button click.delegate="search()" disabled.to-view="!query.q">Search</button>
        </div>
      </div>
    </div>
        
    <div>
      <div if.bind="data" class="mdc-layout-grid">
        <mdc-layout-grid class="demo-grid">
          <mdc-layout-grid-inner>
            <mdc-layout-grid-cell span="6">
              <mdc-form-field repeat.for="source of searchSources">
                <mdc-radio model.bind="source.key" checked.bind="query.source" change.trigger="searchSourceChanged()"></mdc-radio>
                <label >${source.label}</label>
              </mdc-form-field>
            <mdc-layout-grid-cell span="6"></mdc-layout-grid-cell>
            <mdc-layout-grid-cell span="2"></mdc-layout-grid-cell>
            <mdc-layout-grid-cell span="10"></mdc-layout-grid-cell>            
          </mdc-layout-grid-inner>

        </mdc-layout-grid>
      </div>      
    </div>
    
      <div mdc-menu-surface-anchor>
        <button  mdc-button class="demo-density-button" mdc-typography-button click.trigger="hierarchical.open = !hierarchical.open" ref="menuEntry">Show Menu<mdc-icon>arrow_drop_down</mdc-icon></button>
        <mdc-menu id="menu1" ref="parentElement" view-model.ref="hierarchical" anchor.bind="menuEntry" anchor-corner="BOTTOM_START" stay-open-on-selection>
          <mdc-list wrap-focus.bind="wrapFocus" tabindex="-1">
            <mdc-list-item mdclistitem:action.trigger="hierarchical.open = false">Item 1</mdc-list-item>
            <mdc-list-item mdclistitem:action.trigger="hierarchical.open = false">Item 2</mdc-list-item>
            <mdc-list-divider></mdc-list-divider>
            <mdc-list-item mdclistitem:action.trigger="(subMenu.open = true) && $event.stopPropagation()" ref="item3">
              Item 3<mdc-icon mdc-list-item-meta>arrow_left</mdc-icon>
            </mdc-list-item>
            <mdc-list-item mdclistitem:action.trigger="hierarchical.open = false">Item 4</mdc-list-item>
          </mdc-list>
        </mdc-menu>
      </div>
      <mdc-menu anchor.bind="item3" 
                mdcmenu:selected.trigger="onMenuSelect($event.detail, searchSources[$event.detail.index])" 
                view-model.ref="subMenu" hoist-to-body anchor-corner="TOP_LEFT" 
                anchor-margin.to-view="{left: (-1 * parentElement.offsetWidth) - 40}">
        <mdc-list tabindex="-1" dir="rtl">
          <mdc-menu-selection-group>
            <mdc-list-item repeat.for="item of searchSources">
              <mdc-icon mdc-menu-selection-group-icon>check</mdc-icon>
              ${item.label}
            </mdc-list-item>
          </mdc-menu-selection-group>
        </mdc-list>
      </mdc-menu>
    
    <!-- <div mdc-menu-surface-anchor ref="demoSelectionAnchor">
      <button mdc-button role="button" click.delegate="demoSelectionGroup.open = !demoSelectionGroup.open">
        Search in...
      </button>
      <mdc-menu view-model.ref="demoSelectionGroup" anchor.bind="demoSelectionAnchor">
        <mdc-list>
          <mdc-menu-selection-group>
            <mdc-list-item>
              <mdc-icon mdc-menu-selection-group-icon>check</mdc-icon>
              Single
            </mdc-list-item>
            <mdc-list-item disabled>
              <mdc-icon mdc-menu-selection-group-icon>check</mdc-icon>
              1.15
            </mdc-list-item>
            <mdc-list-item>
              <mdc-icon mdc-menu-selection-group-icon>check</mdc-icon>
              Double
            </mdc-list-item>
            <mdc-list-item>
              <mdc-icon mdc-menu-selection-group-icon>check</mdc-icon>
              Custom: 1.2
            </mdc-list-item>
          </mdc-menu-selection-group>
          <mdc-list-divider></mdc-list-divider>
          <mdc-menu-selection-group>
            <mdc-list-item>
              <mdc-icon mdc-menu-selection-group-icon>check</mdc-icon>
              Item
            </mdc-list-item>
            <mdc-list-item>
              <mdc-icon mdc-menu-selection-group-icon>check</mdc-icon>
              Another Item
            </mdc-list-item>
          </mdc-menu-selection-group>
          <mdc-list-divider></mdc-list-divider>
          <li class="mdc-list-item mdc-list-submenu" role="menuitem" tabindex="0"> A Sub Menu
            <div class="mdc-simple-menu" tabindex="-1">
                <ul class="mdc-simple-menu__items mdc-list" role="menu" aria-hidden="true">
                    <li class="mdc-list-item" role="menuitem" tabindex="0"> Sub menu entry 1 </li>
                    <li class="mdc-list-item" role="menuitem" tabindex="0"> Sub menu entry 2 </li>
                </ul>
            </div>
          </li>
         
          <mdc-list-item>Add space after paragraph</mdc-list-item>
          <mdc-list-divider></mdc-list-divider>
          <mdc-list-item>Custom spacing...</mdc-list-item>
        </mdc-list>
      </mdc-menu>
    </div> -->
            
    <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-6">

    </div>  
    
    <div>
      <div class="mdc-layout-grid">
        <!-- The item starts here -->
        <div class="mdc-layout-grid__inner search-item" repeat.for="item of data.items">
          <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12">
            <div class="mdc-layout-grid__inner">
              <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-4">
                <a href="#" title="Link to Main Case of the Document">
                  ${item.document.title}
                </a>
              </div>
              <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-4">
                <a href="#" title="Link to the Document">
                  ${item.mainCase.id}
                </a>
              </div>
              <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-4">
                <a repeat.for="filter of item.filteredWith" href="#">${filter.value}</a>
              </div>
            </div>
            <div class="mdc-layout-grid__inner">
              <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12">
                <span repeat.for="fragment of item.fragments">
                  <span repeat.for="word of fragment.text.split(' ')" class="${getHighlightItemIndex($index, fragment) ? 'text-fragment__highlight' : ''}">${word}${$last ? '...': ' '}</span>
                </span>
              </div>
            </div>
            <div class="mdc-layout-grid__inner">
              <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12">
                <mdc-expandable  class="mdc-expandable"
                                 accordion>
                  <div slot="caption">
                    <div class="caption__item">
                      <span class="caption__item-text">דירוג:</span>
                      <span class="caption__item-text" repeat.for="rank of item.ranks">
                        <span>${rank.name} - ${rank.value}</span>
                      </span>
                    </div>
                    <div class="caption__item">
                      <span class="caption__item-text">quibusdam</span>
                    </div>
                  </div>
                  <div class="content__wrapper">
                    <div class="content-item">
                      <span class="content__item-title"><b>ישויות:</b></span>
                      <div class="content-item-body">
                        something...
                      </div>
                    </div>
                    <div class="content__item">
                    <span class="content__item-title"><b>תיקים קשורים:</b></span>
                      <div class="content__item-body">
                        something...
                      </div>
                    </div>
                  </div>
                </mdc-expandable>
              </div>
            </div>
            <div class="mdc-layout-grid__inner">
            </div>
          </div>          
        </div>        
        <!-- The item ends here -->
      </div>      
    </div>
    

</template>
